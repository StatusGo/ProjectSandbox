<apex:page StandardController="Project_Schedule__c" extensions="ExportProjectcontroller"  cache="true" contentType="application/vnd.ms-excel#Project_Schedule.xls" showheader="false" sidebar="false">

    <div align="left">  
        <apex:image url="{!imageURL}" width="275" height="60"/>
    </div>

<p> Project Schedule Tasks</p><br/>

<apex:outputLabel value="<b>Generated By: </b>" escape="false"></apex:outputLabel>
<apex:outputText style="font-weight:bold;" value="{!U.Name}"/><br/>
<apex:outputLabel value="<b>Generated Date/Time: </b>" escape="false"></apex:outputLabel>
<apex:outputText value="{!dateTimeValue}"/><br/><br/><br/>

<table>

    <tr>
        <th>Project Schedule Task Name</th>
        <th>Status</th>
        <th>Start Date</th>
        <th>Due Date</th>
        <th>Completed Date</th>
        <th>Owner</th>
    </tr>
    <apex:repeat value="{!phaseName}" var="phase">
        <tr><td colspan="6"><b><u>{!phase}</u></b></td></tr>
        <apex:repeat value="{!phasePSTMap[phase]}" var="pt">
        <tr>
         <td>
            <apex:outputText value="{!pt.Name}" escape="false"/>
             </td>
            
            <td>
            <apex:outputText value="{!pt.Status__c}" escape="false"/>
             </td>
             <td>
            <apex:outputText value="{0,date,MM/dd/yy}" escape="false"><apex:param value="{!pt.Start_Date__c}"/>
                </apex:outputText>
             </td>
             <td>
            <apex:outputText value="{0,date,MM/dd/yy}" escape="false"><apex:param value="{!pt.Due_Date__c}"/>
            </apex:outputText> 
             </td>
             <td>
            <apex:outputText value="{0,date,MM/dd/yy}" escape="false"><apex:param value="{!pt.Completed_Date__c}"/>
            </apex:outputText> 
             </td>
             <td>
            <apex:outputText value="{!pt.Owner__r.Name}" escape="false"/>
             </td>
        </tr> 
        </apex:repeat>
    </apex:repeat>
</table><br/><br/><br/>
<p> Proprietary and Confidential</p>

</apex:page>